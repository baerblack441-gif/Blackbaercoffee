no<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Black Bear | Ultra Luxury</title>
    
    <!-- Premium Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@200;300;400;500;700&family=Cinzel:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <style>
        /* --- THE ONE MILLION DOLLAR VARIABLES --- */
        :root {
            --bg-deep: #050505;
            --bg-card: #0e0e0e;
            --gold-primary: #D4AF37;
            --gold-gradient: linear-gradient(135deg, #D4AF37 0%, #AA8A26 100%);
            --text-main: #f0f0f0;
            --text-muted: #888888;
            --font-main: 'Cinzel', serif; /* Changed main font to Cinzel for English */
            --font-body: 'IBM Plex Sans Arabic', sans-serif;
        }

        /* --- RESET & BASE --- */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0; padding: 0; outline: none; }
        
        body {
            background-color: var(--bg-deep);
            color: var(--text-main);
            font-family: var(--font-body);
            overflow-x: hidden;
            padding-bottom: 100px;
        }

        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 2px; }

        /* --- LOADING SCREEN --- */
        .loader-wrapper {
            position: fixed; inset: 0; background: #000; z-index: 9999;
            display: flex; justify-content: center; align-items: center; flex-direction: column;
            transition: opacity 0.8s ease;
        }
        .loader-logo { font-family: var(--font-main); font-size: 2rem; letter-spacing: 5px; color: var(--gold-primary); animation: pulse 2s infinite; }
        .loader-line { width: 0; height: 1px; background: var(--gold-primary); margin-top: 10px; transition: width 1s ease; }
        @keyframes pulse { 0%, 100% { opacity: 0.5; } 50% { opacity: 1; } }

        /* --- HEADER --- */
        .cinematic-header {
            position: relative; height: 42vh; width: 100%;
            overflow: hidden;
            border-bottom-left-radius: 30px;
            border-bottom-right-radius: 30px;
        }
        .video-bg {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            object-fit: cover; filter: brightness(0.5);
            animation: slowPan 20s infinite alternate;
        }
        @keyframes slowPan { from { transform: scale(1); } to { transform: scale(1.15); } }
        
        .header-overlay {
            position: absolute; inset: 0;
            background: linear-gradient(to top, var(--bg-deep) 0%, transparent 80%);
            display: flex; flex-direction: column; justify-content: flex-end; padding: 25px;
            align-items: center; text-align: center;
        }
        
        /* LOGO STYLES */
        .logo-placeholder {
            width: 80px; height: 80px;
            border-radius: 50%;
            border: 2px solid var(--gold-primary);
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.3);
            margin-bottom: 15px;
            overflow: hidden;
            background: #000;
        }
        .logo-placeholder img { width: 100%; height: 100%; object-fit: contain; }

        .brand-block h1 {
            font-family: var(--font-main); font-size: 2.5rem; letter-spacing: 2px;
            background: var(--gold-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            margin-bottom: 5px; text-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        .brand-block p { color: #ccc; font-size: 0.8rem; letter-spacing: 2px; text-transform: uppercase; opacity: 0.9; }

        /* --- SEARCH BAR OVERLAY --- */
        .search-container {
            height: 0; overflow: hidden; transition: 0.4s cubic-bezier(0.2, 0.8, 0.2, 1);
            background: #111; padding: 0 20px;
            display: flex; align-items: center; border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .search-container.active { height: 70px; padding: 15px 20px; }
        
        .search-box {
            width: 100%; background: #222; border-radius: 10px; 
            display: flex; align-items: center; padding: 0 15px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .search-box input {
            width: 100%; background: transparent; border: none; color: white;
            padding: 10px; font-size: 1rem; font-family: var(--font-body);
        }
        .close-search { color: #888; padding: 10px; cursor: pointer; }

        /* --- STICKY NAV --- */
        .cat-sticky {
            position: sticky; top: 0; z-index: 100;
            background: rgba(5, 5, 5, 0.9); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            padding: 15px 0; border-bottom: 1px solid rgba(255,255,255,0.05);
            margin-top: -30px;
            border-top-left-radius: 30px; border-top-right-radius: 30px;
        }
        .cat-list {
            display: flex; gap: 12px; overflow-x: auto; padding: 0 20px;
            scrollbar-width: none;
        }
        .cat-list::-webkit-scrollbar { display: none; }

        .cat-chip {
            padding: 10px 22px; border-radius: 30px;
            font-size: 0.85rem; font-weight: 500; color: #aaa; text-transform: uppercase; letter-spacing: 1px;
            background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.08);
            transition: all 0.4s cubic-bezier(0.2, 0.8, 0.2, 1);
            white-space: nowrap; cursor: pointer;
        }
        .cat-chip.active {
            background: var(--gold-primary); color: #000; border-color: var(--gold-primary);
            font-weight: 700; box-shadow: 0 0 25px rgba(212, 175, 55, 0.4); transform: scale(1.05);
        }

        /* --- GRID LAYOUT --- */
        .menu-container { padding: 25px 20px; min-height: 400px; }

        .product-card {
            display: flex; align-items: center; gap: 15px;
            background: var(--bg-card); padding: 12px; margin-bottom: 18px;
            border-radius: 20px; border: 1px solid rgba(255,255,255,0.05);
            position: relative; overflow: hidden; transition: 0.3s;
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }
        .product-card:active { transform: scale(0.98); }
        .product-card::before {
            content: ''; position: absolute; top: 0; left: 0; width: 4px; height: 100%;
            background: var(--gold-primary); opacity: 0; transition: 0.3s;
        }
        .product-card.active-card::before { opacity: 1; }

        .p-img-box {
            width: 90px; height: 90px; flex-shrink: 0; border-radius: 16px; overflow: hidden;
            position: relative; border: 1px solid rgba(255,255,255,0.1);
        }
        .p-img { width: 100%; height: 100%; object-fit: cover; transition: 0.5s; }
        
        .p-info { flex: 1; display: flex; flex-direction: column; justify-content: center; }
        .p-title {
            font-size: 1.1rem; font-weight: 600; margin-bottom: 6px; color: #fff;
            letter-spacing: 0.5px;
        }
        .p-desc {
            font-size: 0.8rem; color: #777; line-height: 1.4;
            display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;
        }
        
        .p-price-box {
            text-align: right; min-width: 75px; display: flex; flex-direction: column; align-items: flex-end;
        }
        .p-price {
            font-family: var(--font-main); color: var(--gold-primary); font-weight: 700; font-size: 1.1rem;
            text-shadow: 0 0 10px rgba(212, 175, 55, 0.3);
        }
        .add-btn {
            margin-top: 10px; width: 35px; height: 35px; border-radius: 50%;
            background: rgba(255,255,255,0.06); display: flex; align-items: center; justify-content: center;
            color: var(--gold-primary); font-size: 0.9rem; transition: 0.3s;
        }

        /* --- BOTTOM NAV --- */
        .bottom-nav {
            position: fixed; bottom: 25px; left: 25px; right: 25px;
            background: rgba(20, 20, 20, 0.8); backdrop-filter: blur(25px); -webkit-backdrop-filter: blur(25px);
            border-radius: 35px; height: 75px;
            display: flex; justify-content: space-evenly; align-items: center; /* Changed to space-evenly for 3 icons */
            border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 15px 50px rgba(0,0,0,0.6); z-index: 500;
        }
        .nav-icon {
            color: #555; font-size: 1.4rem; padding: 10px; transition: 0.4s;
            position: relative; display: flex; flex-direction: column; align-items: center;
            cursor: pointer;
        }
        .nav-icon.active { color: var(--gold-primary); transform: translateY(-5px); }
        .nav-icon.active i { filter: drop-shadow(0 0 8px var(--gold-primary)); }

        /* --- FULL SCREEN MODAL --- */
        .fs-modal {
            position: fixed; inset: 0; background: var(--bg-deep); z-index: 2000;
            transform: translateY(100%); transition: transform 0.6s cubic-bezier(0.7, 0, 0.3, 1);
            display: flex; flex-direction: column;
        }
        .fs-modal.open { transform: translateY(0); }
        
        .modal-hero { height: 50vh; position: relative; }
        .modal-hero img { width: 100%; height: 100%; object-fit: cover; mask-image: linear-gradient(to bottom, black 70%, transparent 100%); -webkit-mask-image: linear-gradient(to bottom, black 70%, transparent 100%); }
        .close-fs {
            position: absolute; top: 30px; right: 30px; width: 45px; height: 45px;
            background: rgba(0,0,0,0.3); backdrop-filter: blur(15px); border-radius: 50%;
            display: flex; align-items: center; justify-content: center; color: white;
            font-size: 1.2rem; cursor: pointer; border: 1px solid rgba(255,255,255,0.1); z-index: 10;
        }

        .modal-content { padding: 35px; margin-top: -60px; position: relative; z-index: 2; }
        .modal-category { color: var(--gold-primary); font-size: 0.85rem; letter-spacing: 2px; text-transform: uppercase; margin-bottom: 12px; font-weight: 700; display: inline-block; padding: 5px 10px; background: rgba(212, 175, 55, 0.1); border-radius: 5px; }
        .modal-h1 { font-family: var(--font-main); font-size: 2.8rem; line-height: 1; margin-bottom: 20px; color: white; }
        .modal-p { color: #b0b0b0; font-size: 1.1rem; line-height: 1.7; margin-bottom: 30px; font-weight: 300; }
        
        .modal-action {
            margin-top: auto; padding: 25px; border-top: 1px solid rgba(255,255,255,0.08);
            display: flex; justify-content: space-between; align-items: center;
            background: rgba(10,10,10,0.9);
        }
        .price-big { font-family: var(--font-main); font-size: 2.2rem; color: white; font-weight: 700; }
        .price-unit { font-size: 1rem; color: var(--gold-primary); margin-left: 5px; } /* Margin left for LTR */
        
        .order-now-btn {
            background: var(--gold-gradient); color: black; padding: 18px 45px;
            border-radius: 50px; font-weight: 700; font-size: 1.1rem; border: none;
            box-shadow: 0 10px 40px rgba(212, 175, 55, 0.25);
            transition: 0.3s; cursor: pointer;
            text-transform: uppercase; letter-spacing: 1px;
        }
        .order-now-btn:active { transform: scale(0.95); box-shadow: 0 5px 20px rgba(212, 175, 55, 0.2); }
    </style>
</head>
<body>

    <!-- LOADER -->
    <div id="loader" class="loader-wrapper">
        <div class="loader-logo">BLACK BEAR</div>
        <div class="loader-line" id="loader-line"></div>
    </div>

    <!-- MAIN CONTENT -->
    <main id="main-content" style="opacity: 0; transition: 1.2s ease-out;">
        
        <header class="cinematic-header">
            <img src="https://images.unsplash.com/photo-1544148103-0773bf10d330?q=80&w=1920" class="video-bg" alt="Luxury Vibe">
            <div class="header-overlay">
                <!-- LOGO PLACEHOLDER: Replace src with your logo URL -->
                <div class="logo-placeholder">
                    <img src="https://www.dropbox.com/scl/fi/bmkly5q5ccvup7txf4jv3/Photo-02-01-2026-11-40-35-PM.jpg?rlkey=4h1ifiglkfnjbqo4zc0psbbd4&st=po5n39cx&raw=1" alt="Black Bear Logo">
                </div>

                <div class="brand-block">
                    <h1>BLACK BEAR</h1>
                    <p>Royal Experience | Since 2026</p>
                </div>
            </div>
        </header>

        <!-- SEARCH OVERLAY -->
        <div class="search-container" id="search-bar">
            <div class="search-box">
                <i class="fas fa-search" style="color:#777;"></i>
                <input type="text" id="search-input" placeholder="Search menu items...">
                <i class="fas fa-times close-search" onclick="toggleSearch()"></i>
            </div>
        </div>

        <!-- STICKY FILTER -->
        <div class="cat-sticky">
            <div class="cat-list" id="category-wrapper">
                <!-- Categories will appear here automatically -->
            </div>
        </div>

        <div class="menu-container" id="menu-container">
            <!-- Items injected by JS -->
        </div>

    </main>

    <!-- BOTTOM NAV (WiFi Removed) -->
    <div class="bottom-nav">
        <div class="nav-icon active" onclick="resetView()"><i class="fas fa-home"></i></div>
        <div class="nav-icon" onclick="toggleSearch()"><i class="fas fa-search"></i></div>
        <!-- Removed WiFi Button -->
    </div>

    <!-- FULL SCREEN DETAIL -->
    <div id="fs-modal" class="fs-modal">
        <div class="modal-hero">
            <img id="m-img" src="">
            <div class="close-fs" onclick="closeModal()"><i class="fas fa-times"></i></div>
        </div>
        <div class="modal-content">
            <div class="modal-category" id="m-cat-text">Signature</div>
            <h1 id="m-title" class="modal-h1">...</h1>
            <p id="m-desc" class="modal-p">...</p>
        </div>
        <div class="modal-action">
            <div class="price-wrapper">
                <span id="m-price" class="price-big">0</span>
                <span class="price-unit">IQD</span>
            </div>
            <button class="order-now-btn">Order Now</button>
        </div>
    </div>

    <!-- FIREBASE & APP LOGIC -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // FIREBASE CONFIG (UNCHANGED)
        const firebaseConfig = {
            apiKey: "AIzaSyBxcHGuFka8TpL-k6Afl7uhidGcQAl_oGA",
            authDomain: "blackbaercoffe.firebaseapp.com",
            projectId: "blackbaercoffe",
            storageBucket: "blackbaercoffe.firebasestorage.app",
            messagingSenderId: "339042366918",
            appId: "1:339042366918:web:db15c4facef5e57d9e6ec7",
            measurementId: "G-02YYCQ0ZZG"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        
        // GLOBAL DATA
        let dbMenuItems = [];
        
        // 1. FETCH DATA
        async function fetchProducts() {
            try {
                const querySnapshot = await getDocs(collection(db, "products"));
                dbMenuItems = [];
                querySnapshot.forEach((doc) => {
                    dbMenuItems.push({ firebaseId: doc.id, ...doc.data() });
                });
                
                initApp(); 
                
            } catch (error) {
                console.error("Error fetching data:", error);
                document.getElementById('loader').style.display = 'none';
                document.getElementById('main-content').style.opacity = '1';
                document.getElementById('menu-container').innerHTML = '<p style="color:white; text-align:center">Connection Error.</p>';
            }
        }

        // 2. INIT APP
        function initApp() {
            const catContainer = document.getElementById('category-wrapper');
            const allCats = ['all', ...new Set(dbMenuItems.map(item => item.cat))];
            
            catContainer.innerHTML = '';
            
            allCats.forEach(cat => {
                // TRANSLATION LOGIC
                let displayName = cat;
                if(cat === 'all') displayName = 'All';
                else if(cat === 'hot') displayName = 'Hot Drinks';
                else if(cat === 'cold') displayName = 'Cold Drinks';
                else if(cat === 'dessert') displayName = 'Desserts';
                else if(cat === 'shisha') displayName = 'Shisha';
                else {
                    displayName = cat.charAt(0).toUpperCase() + cat.slice(1);
                }

                catContainer.innerHTML += `
                    <div class="cat-chip ${cat === 'all' ? 'active' : ''}" onclick="setCategory('${cat}', this)">
                        ${displayName}
                    </div>
                `;
            });

            renderMenu('all');
            
            const line = document.getElementById('loader-line');
            line.style.width = '120px'; 
            setTimeout(() => {
                document.getElementById('loader').style.opacity = '0';
                document.getElementById('main-content').style.opacity = '1';
                setTimeout(() => document.getElementById('loader').style.display = 'none', 800);
            }, 800);
        }

        // 3. RENDER FUNCTION (Supports filtering)
        window.renderMenu = function(filterStr, isSearch = false) {
            const container = document.getElementById('menu-container');
            container.innerHTML = '';
            
            let filtered = [];
            
            if(isSearch) {
                // Filter by name (case insensitive)
                const term = filterStr.toLowerCase();
                filtered = dbMenuItems.filter(i => i.name.toLowerCase().includes(term));
            } else {
                // Filter by Category
                filtered = filterStr === 'all' ? dbMenuItems : dbMenuItems.filter(i => i.cat === filterStr);
            }
            
            if(filtered.length === 0) {
                container.innerHTML = '<p style="text-align:center; color:#555; margin-top:50px;">No items found.</p>';
                return;
            }

            filtered.forEach((item, index) => {
                const delay = index * 50; // Faster animation
                container.innerHTML += `
                <div class="product-card" onclick="openProduct('${item.firebaseId}')" style="animation: fadeInUp 0.5s cubic-bezier(0.2, 0.8, 0.2, 1) forwards ${delay}ms; opacity: 0; transform: translateY(20px);">
                    <div class="p-img-box">
                        <img src="${item.img}" class="p-img" loading="lazy" onerror="this.src='https://via.placeholder.com/150?text=Black+Bear'">
                    </div>
                    <div class="p-info">
                        <div class="p-title">${item.name}</div>
                        <div class="p-desc">${item.desc}</div>
                    </div>
                    <div class="p-price-box">
                        <div class="p-price">${(Number(item.price)/1000).toFixed(1)}K</div>
                        <div class="add-btn"><i class="fas fa-arrow-right" style="transform: rotate(-45deg);"></i></div>
                    </div>
                </div>
                `;
            });
        }

        // 4. OPEN PRODUCT MODAL
        window.openProduct = function(fId) {
            const item = dbMenuItems.find(i => i.firebaseId === fId);
            if(!item) return;

            document.getElementById('m-img').src = item.img;
            document.getElementById('m-title').innerText = item.name;
            document.getElementById('m-desc').innerText = item.desc;
            document.getElementById('m-price').innerText = Number(item.price).toLocaleString();
            
            let displayCat = item.cat.toUpperCase();
            document.getElementById('m-cat-text').innerText = displayCat;

            document.getElementById('fs-modal').classList.add('open');
        }

        // 5. SEARCH LOGIC
        const searchInput = document.getElementById('search-input');
        searchInput.addEventListener('input', (e) => {
            const val = e.target.value;
            if(val.length > 0) {
                window.renderMenu(val, true); // True means search mode
            } else {
                // If empty, revert to currently selected category (or all)
                const activeCat = document.querySelector('.cat-chip.active');
                const catName = activeCat ? getCatFromElement(activeCat) : 'all';
                window.renderMenu('all'); // Simplification: go to all
            }
        });

        // Helper to get category name back from text (simple version defaults to 'all' on search clear)
        
        fetchProducts();

    </script>

    <!-- UI HELPERS -->
    <script>
        // Category Selection
        function setCategory(cat, el) {
            document.querySelectorAll('.cat-chip').forEach(c => c.classList.remove('active'));
            el.classList.add('active');
            if (navigator.vibrate) navigator.vibrate(10);
            
            // Clear search when changing category
            document.getElementById('search-input').value = '';
            
            if(window.renderMenu) window.renderMenu(cat, false);
        }

        // Modal Control
        function closeModal() {
            document.getElementById('fs-modal').classList.remove('open');
        }

        // Search Toggle
        function toggleSearch() {
            const bar = document.getElementById('search-bar');
            bar.classList.toggle('active');
            if(bar.classList.contains('active')) {
                setTimeout(() => document.getElementById('search-input').focus(), 100);
            } else {
                document.getElementById('search-input').value = '';
                window.renderMenu('all'); // Reset
            }
        }
        
        function resetView() {
            // Closes search and goes to top
            document.getElementById('search-bar').classList.remove('active');
            window.scrollTo({top:0, behavior:'smooth'});
            // Reset to 'All'
            const allBtn = document.querySelector('.cat-chip'); 
            if(allBtn) setCategory('all', allBtn);
        }

        // Animation
        const styleSheet = document.createElement("style");
        styleSheet.innerText = `
            @keyframes fadeInUp {
                to { opacity: 1; transform: translateY(0); }
            }
        `;
        document.head.appendChild(styleSheet);
    </script>
</body>
</html>
